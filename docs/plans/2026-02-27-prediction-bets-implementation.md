# Prediction Bets — Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Build a trilingual (EN/PT/ES) prediction markets content site with community forum, powered by an AI content pipeline.

**Architecture:** Next.js 15 App Router with SSR for SEO. Markdown content generated by a Python agent pipeline (fetch → rewrite → translate → publish). PostgreSQL + Prisma for forum data. NextAuth.js for social login. Dark-mode Polymarket-inspired UI.

**Tech Stack:** Next.js 15, Tailwind CSS 3, TypeScript, next-intl, NextAuth.js, Prisma, PostgreSQL (Neon/Supabase), Python 3.12, Claude API, Unsplash API.

---

## Task 1: Project Scaffold

**Files:**
- Create: `site/package.json`
- Create: `site/tsconfig.json`
- Create: `site/next.config.ts`
- Create: `site/tailwind.config.ts`
- Create: `site/postcss.config.js`
- Create: `site/.gitignore`
- Create: `site/src/app/layout.tsx`
- Create: `site/src/app/page.tsx`
- Create: `site/src/styles/globals.css`

**Step 1: Initialize Next.js project**

```bash
cd /Users/macbookjoaohomem/Documents/VSCode_Projects/prediction_bets
npx create-next-app@latest site --typescript --tailwind --eslint --app --src-dir --no-import-alias --use-npm
```

Expected: New `site/` directory with Next.js 15 boilerplate.

**Step 2: Install core dependencies**

```bash
cd site
npm install next-intl@^3.25 gray-matter remark remark-html
npm install -D @types/node @types/react @types/react-dom
```

Expected: Dependencies added to package.json.

**Step 3: Verify dev server starts**

```bash
cd site && npm run dev
```

Expected: Server running on localhost:3000 with default Next.js page.

**Step 4: Commit**

```bash
git init
git add -A
git commit -m "feat: scaffold Next.js 15 project with Tailwind"
```

---

## Task 2: Design System — Tailwind Config & Global Styles

**Files:**
- Modify: `site/tailwind.config.ts`
- Modify: `site/src/styles/globals.css`
- Create: `site/src/lib/fonts.ts`

**Step 1: Configure Tailwind with Prediction Bets design tokens**

```typescript
// site/tailwind.config.ts
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        pb: {
          bg: {
            primary: "#0D0F14",
            secondary: "#13161D",
            surface: "#1A1D27",
            "surface-hover": "#22263A",
          },
          accent: {
            blue: "#2D7FF9",
            "blue-hover": "#1A6DE0",
            amber: "#F5A623",
            "amber-hover": "#E09516",
          },
          success: "#22C55E",
          danger: "#EF4444",
          text: {
            primary: "#F8FAFC",
            secondary: "#94A3B8",
            muted: "#64748B",
          },
        },
      },
      fontFamily: {
        sans: ["var(--font-inter)", "system-ui", "sans-serif"],
        mono: ["var(--font-jetbrains)", "monospace"],
      },
      fontSize: {
        "display-xl": ["3.5rem", { lineHeight: "1.1", fontWeight: "800" }],
        "display-lg": ["2.5rem", { lineHeight: "1.15", fontWeight: "700" }],
        "display-md": ["2rem", { lineHeight: "1.2", fontWeight: "700" }],
      },
    },
  },
  plugins: [],
};
export default config;
```

**Step 2: Set up global CSS with dark mode defaults**

```css
/* site/src/styles/globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply bg-pb-bg-primary text-pb-text-primary antialiased;
  }

  ::selection {
    @apply bg-pb-accent-blue/30 text-white;
  }

  /* Scrollbar styling for dark mode */
  ::-webkit-scrollbar {
    @apply w-2;
  }
  ::-webkit-scrollbar-track {
    @apply bg-pb-bg-secondary;
  }
  ::-webkit-scrollbar-thumb {
    @apply bg-pb-text-muted rounded-full;
  }
}

@layer components {
  .card {
    @apply bg-pb-bg-surface rounded-xl border border-white/5
           hover:border-pb-accent-blue/20 transition-all duration-200;
  }

  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs
           font-medium uppercase tracking-wider;
  }

  .badge-blue {
    @apply badge bg-pb-accent-blue/10 text-pb-accent-blue;
  }

  .badge-amber {
    @apply badge bg-pb-accent-amber/10 text-pb-accent-amber;
  }

  .btn-primary {
    @apply inline-flex items-center justify-center px-6 py-3
           bg-pb-accent-blue hover:bg-pb-accent-blue-hover
           text-white font-semibold rounded-lg transition-colors;
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center px-6 py-3
           bg-pb-bg-surface hover:bg-pb-bg-surface-hover
           text-pb-text-primary border border-white/10
           font-semibold rounded-lg transition-colors;
  }
}
```

**Step 3: Set up font loading**

```typescript
// site/src/lib/fonts.ts
import { Inter, JetBrains_Mono } from "next/font/google";

export const inter = Inter({
  subsets: ["latin"],
  variable: "--font-inter",
  display: "swap",
});

export const jetbrains = JetBrains_Mono({
  subsets: ["latin"],
  variable: "--font-jetbrains",
  display: "swap",
});
```

**Step 4: Update root layout with fonts and dark mode**

```tsx
// site/src/app/layout.tsx
import type { ReactNode } from "react";
import { inter, jetbrains } from "@/lib/fonts";
import "@/styles/globals.css";

export const metadata = {
  title: "Prediction Bets",
  description: "The cultural center of prediction markets",
};

export default function RootLayout({ children }: { children: ReactNode }) {
  return (
    <html lang="en" className={`dark ${inter.variable} ${jetbrains.variable}`}>
      <body className="min-h-screen flex flex-col font-sans">
        {children}
      </body>
    </html>
  );
}
```

**Step 5: Verify dark mode renders correctly**

```bash
cd site && npm run dev
```

Expected: Dark background (#0D0F14), white text, correct fonts loading.

**Step 6: Commit**

```bash
git add -A
git commit -m "feat: design system with Polymarket-inspired dark theme"
```

---

## Task 3: Internationalization (i18n) Setup

**Files:**
- Create: `site/src/i18n/routing.ts`
- Create: `site/src/i18n/request.ts`
- Create: `site/src/i18n/navigation.ts`
- Create: `site/messages/en.json`
- Create: `site/messages/pt.json`
- Create: `site/messages/es.json`
- Create: `site/src/middleware.ts`
- Modify: `site/next.config.ts`
- Create: `site/src/app/[locale]/layout.tsx`
- Create: `site/src/app/[locale]/page.tsx`
- Remove/modify: `site/src/app/layout.tsx` (move to locale layout)
- Remove: `site/src/app/page.tsx` (move to locale page)

**Step 1: Install next-intl plugin**

```bash
cd site && npm install next-intl@^3.25
```

**Step 2: Create routing config**

```typescript
// site/src/i18n/routing.ts
import { defineRouting } from "next-intl/routing";

export const routing = defineRouting({
  locales: ["en", "pt", "es"],
  defaultLocale: "en",
});
```

**Step 3: Create request config**

```typescript
// site/src/i18n/request.ts
import { getRequestConfig } from "next-intl/server";
import { routing } from "./routing";

export default getRequestConfig(async ({ requestLocale }) => {
  let locale = await requestLocale;

  if (!locale || !routing.locales.includes(locale as any)) {
    locale = routing.defaultLocale;
  }

  return {
    locale,
    messages: (await import(`../../messages/${locale}.json`)).default,
  };
});
```

**Step 4: Create navigation helpers**

```typescript
// site/src/i18n/navigation.ts
import { createNavigation } from "next-intl/navigation";
import { routing } from "./routing";

export const { Link, redirect, usePathname, useRouter } =
  createNavigation(routing);
```

**Step 5: Create middleware**

```typescript
// site/src/middleware.ts
import createMiddleware from "next-intl/middleware";
import { routing } from "./i18n/routing";

export default createMiddleware(routing);

export const config = {
  matcher: ["/((?!api|_next|_vercel|.*\\..*).*)"],
};
```

**Step 6: Update next.config.ts**

```typescript
// site/next.config.ts
import createNextIntlPlugin from "next-intl/plugin";

const withNextIntl = createNextIntlPlugin("./src/i18n/request.ts");

const nextConfig = {};

export default withNextIntl(nextConfig);
```

**Step 7: Create message files**

```json
// site/messages/en.json
{
  "nav": {
    "home": "Home",
    "trending": "Trending",
    "politics": "Politics",
    "crypto": "Crypto",
    "aiTech": "AI & Tech",
    "sports": "Sports",
    "markets": "Markets",
    "culture": "Culture",
    "geopolitics": "Geopolitics",
    "community": "Community",
    "about": "About",
    "newsletter": "Newsletter",
    "signIn": "Sign In",
    "joinTribe": "Join the Tribe"
  },
  "home": {
    "hero": "Reality beats opinion. Markets reveal truth.",
    "subtitle": "The cultural center of prediction markets.",
    "trending": "Trending",
    "featured": "Featured",
    "latest": "Latest Signal",
    "readMore": "Read more",
    "joinCta": "Join the tribe. See the signal.",
    "newsletterCta": "Get the daily signal briefing."
  },
  "article": {
    "by": "By",
    "readTime": "{minutes} min read",
    "related": "Related Signal",
    "share": "Share this signal",
    "joinDiscussion": "Join the discussion"
  },
  "community": {
    "title": "The Tribe",
    "subtitle": "Where predictions meet accountability.",
    "newThread": "Drop Signal",
    "reply": "Reply",
    "upvote": "Signal",
    "sections": {
      "signalDrop": "Signal Drop",
      "contrarianTakes": "Contrarian Takes",
      "predictionBattles": "Prediction Battles",
      "realityCheck": "Reality Check",
      "edgeLab": "Edge Lab",
      "offMarket": "Off-Market"
    }
  },
  "about": {
    "title": "The Movement",
    "creed": "Our Creed",
    "story": "Creation Story",
    "words": "Sacred Words"
  },
  "auth": {
    "signIn": "Sign In",
    "signUp": "Join the Tribe",
    "email": "Email",
    "password": "Password",
    "orContinueWith": "Or continue with",
    "verifyEmail": "Check your email to verify your account."
  },
  "footer": {
    "tagline": "Reality beats opinion. Markets reveal truth.",
    "rights": "All rights reserved."
  }
}
```

```json
// site/messages/pt.json
{
  "nav": {
    "home": "Inicio",
    "trending": "Em Alta",
    "politics": "Politica",
    "crypto": "Crypto",
    "aiTech": "IA & Tech",
    "sports": "Esportes",
    "markets": "Mercados",
    "culture": "Cultura",
    "geopolitics": "Geopolitica",
    "community": "Comunidade",
    "about": "Sobre",
    "newsletter": "Newsletter",
    "signIn": "Entrar",
    "joinTribe": "Entre na Tribo"
  },
  "home": {
    "hero": "Realidade vence opiniao. Mercados revelam verdade.",
    "subtitle": "O epicentro cultural dos mercados de previsao.",
    "trending": "Em Alta",
    "featured": "Destaque",
    "latest": "Ultimo Signal",
    "readMore": "Leia mais",
    "joinCta": "Entre na tribo. Veja o signal.",
    "newsletterCta": "Receba o briefing diario de signal."
  },
  "article": {
    "by": "Por",
    "readTime": "{minutes} min de leitura",
    "related": "Signal Relacionado",
    "share": "Compartilhe este signal",
    "joinDiscussion": "Entre na discussao"
  },
  "community": {
    "title": "A Tribo",
    "subtitle": "Onde previsoes encontram responsabilidade.",
    "newThread": "Dropar Signal",
    "reply": "Responder",
    "upvote": "Signal",
    "sections": {
      "signalDrop": "Signal Drop",
      "contrarianTakes": "Takes Contrarios",
      "predictionBattles": "Batalhas de Previsao",
      "realityCheck": "Reality Check",
      "edgeLab": "Edge Lab",
      "offMarket": "Off-Market"
    }
  },
  "about": {
    "title": "O Movimento",
    "creed": "Nosso Credo",
    "story": "Historia de Criacao",
    "words": "Palavras Sagradas"
  },
  "auth": {
    "signIn": "Entrar",
    "signUp": "Junte-se a Tribo",
    "email": "Email",
    "password": "Senha",
    "orContinueWith": "Ou continue com",
    "verifyEmail": "Verifique seu email para confirmar sua conta."
  },
  "footer": {
    "tagline": "Realidade vence opiniao. Mercados revelam verdade.",
    "rights": "Todos os direitos reservados."
  }
}
```

```json
// site/messages/es.json
{
  "nav": {
    "home": "Inicio",
    "trending": "Tendencias",
    "politics": "Politica",
    "crypto": "Crypto",
    "aiTech": "IA & Tech",
    "sports": "Deportes",
    "markets": "Mercados",
    "culture": "Cultura",
    "geopolitics": "Geopolitica",
    "community": "Comunidad",
    "about": "Acerca de",
    "newsletter": "Newsletter",
    "signIn": "Iniciar Sesion",
    "joinTribe": "Unete a la Tribu"
  },
  "home": {
    "hero": "La realidad vence a la opinion. Los mercados revelan la verdad.",
    "subtitle": "El epicentro cultural de los mercados de prediccion.",
    "trending": "Tendencias",
    "featured": "Destacado",
    "latest": "Ultima Signal",
    "readMore": "Leer mas",
    "joinCta": "Unete a la tribu. Ve la signal.",
    "newsletterCta": "Recibe el briefing diario de signal."
  },
  "article": {
    "by": "Por",
    "readTime": "{minutes} min de lectura",
    "related": "Signal Relacionada",
    "share": "Comparte esta signal",
    "joinDiscussion": "Unete a la discusion"
  },
  "community": {
    "title": "La Tribu",
    "subtitle": "Donde las predicciones encuentran responsabilidad.",
    "newThread": "Soltar Signal",
    "reply": "Responder",
    "upvote": "Signal",
    "sections": {
      "signalDrop": "Signal Drop",
      "contrarianTakes": "Takes Contrarios",
      "predictionBattles": "Batallas de Prediccion",
      "realityCheck": "Reality Check",
      "edgeLab": "Edge Lab",
      "offMarket": "Off-Market"
    }
  },
  "about": {
    "title": "El Movimiento",
    "creed": "Nuestro Credo",
    "story": "Historia de Creacion",
    "words": "Palabras Sagradas"
  },
  "auth": {
    "signIn": "Iniciar Sesion",
    "signUp": "Unete a la Tribu",
    "email": "Correo",
    "password": "Contrasena",
    "orContinueWith": "O continua con",
    "verifyEmail": "Revisa tu correo para verificar tu cuenta."
  },
  "footer": {
    "tagline": "La realidad vence a la opinion. Los mercados revelan la verdad.",
    "rights": "Todos los derechos reservados."
  }
}
```

**Step 8: Create locale layout (replaces root layout for pages)**

```tsx
// site/src/app/[locale]/layout.tsx
import type { ReactNode } from "react";
import { NextIntlClientProvider } from "next-intl";
import { getMessages } from "next-intl/server";
import { notFound } from "next/navigation";
import { routing } from "@/i18n/routing";
import { inter, jetbrains } from "@/lib/fonts";

type Props = {
  children: ReactNode;
  params: Promise<{ locale: string }>;
};

export function generateStaticParams() {
  return routing.locales.map((locale) => ({ locale }));
}

export default async function LocaleLayout({ children, params }: Props) {
  const { locale } = await params;

  if (!routing.locales.includes(locale as "en" | "pt" | "es")) {
    notFound();
  }

  const messages = await getMessages();

  return (
    <NextIntlClientProvider messages={messages}>
      {children}
    </NextIntlClientProvider>
  );
}
```

**Step 9: Create placeholder locale page**

```tsx
// site/src/app/[locale]/page.tsx
import { useTranslations } from "next-intl";

export default function HomePage() {
  const t = useTranslations("home");
  return (
    <div className="flex flex-col items-center justify-center min-h-screen p-8">
      <h1 className="text-display-xl text-pb-text-primary mb-4">
        PREDICTION BETS
      </h1>
      <p className="text-xl text-pb-accent-blue font-mono">
        {t("hero")}
      </p>
    </div>
  );
}
```

**Step 10: Update root layout to be minimal (locale layout handles providers)**

```tsx
// site/src/app/layout.tsx
import type { ReactNode } from "react";
import { inter, jetbrains } from "@/lib/fonts";
import "@/styles/globals.css";

export const metadata = {
  title: "Prediction Bets",
  description: "The cultural center of prediction markets. Reality beats opinion.",
};

export default function RootLayout({ children }: { children: ReactNode }) {
  return (
    <html className={`dark ${inter.variable} ${jetbrains.variable}`}>
      <body className="min-h-screen flex flex-col font-sans">
        {children}
      </body>
    </html>
  );
}
```

**Step 11: Verify i18n works**

```bash
cd site && npm run dev
```

Visit:
- `localhost:3000/en` → English text
- `localhost:3000/pt` → Portuguese text
- `localhost:3000/es` → Spanish text
- `localhost:3000` → Redirects to `/en`

**Step 12: Commit**

```bash
git add -A
git commit -m "feat: i18n setup with EN/PT/ES using next-intl"
```

---

## Task 4: Header & Navigation Component

**Files:**
- Create: `site/src/components/Header.tsx`
- Create: `site/src/components/MobileMenu.tsx`
- Create: `site/src/components/LanguageSwitcher.tsx`
- Modify: `site/src/app/[locale]/layout.tsx`

**Step 1: Create Header component**

The header follows Polymarket's pattern: logo left, category tabs center, auth buttons right. Dark background, clean horizontal nav.

```tsx
// site/src/components/Header.tsx
"use client";

import { useState } from "react";
import { useTranslations } from "next-intl";
import { Link, usePathname } from "@/i18n/navigation";
import LanguageSwitcher from "./LanguageSwitcher";
import MobileMenu from "./MobileMenu";

const categories = [
  { key: "trending", href: "/" },
  { key: "politics", href: "/category/politics" },
  { key: "crypto", href: "/category/crypto" },
  { key: "aiTech", href: "/category/ai-tech" },
  { key: "sports", href: "/category/sports" },
  { key: "markets", href: "/category/markets" },
  { key: "culture", href: "/category/culture" },
] as const;

export default function Header() {
  const t = useTranslations("nav");
  const pathname = usePathname();
  const [mobileOpen, setMobileOpen] = useState(false);

  return (
    <header className="sticky top-0 z-50 bg-pb-bg-primary/95 backdrop-blur-md border-b border-white/5">
      <div className="max-w-7xl mx-auto px-4 sm:px-6">
        {/* Top bar */}
        <div className="flex items-center justify-between h-16">
          {/* Logo */}
          <Link href="/" className="flex items-center gap-2">
            <span className="text-xl font-bold text-pb-text-primary tracking-tight">
              PREDICTION<span className="text-pb-accent-blue">BETS</span>
            </span>
          </Link>

          {/* Desktop nav */}
          <nav className="hidden md:flex items-center gap-1">
            {categories.map(({ key, href }) => {
              const isActive = pathname === href ||
                (href !== "/" && pathname.startsWith(href));
              return (
                <Link
                  key={key}
                  href={href}
                  className={`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${
                    isActive
                      ? "text-pb-accent-blue bg-pb-accent-blue/10"
                      : "text-pb-text-secondary hover:text-pb-text-primary hover:bg-pb-bg-surface"
                  }`}
                >
                  {t(key)}
                </Link>
              );
            })}
          </nav>

          {/* Right side */}
          <div className="flex items-center gap-3">
            <Link
              href="/community"
              className="hidden sm:inline-flex text-sm text-pb-text-secondary hover:text-pb-text-primary transition-colors"
            >
              {t("community")}
            </Link>
            <LanguageSwitcher />
            <Link href="/auth/signin" className="btn-primary text-sm py-2 px-4">
              {t("joinTribe")}
            </Link>
            {/* Mobile hamburger */}
            <button
              className="md:hidden p-2 text-pb-text-secondary"
              onClick={() => setMobileOpen(!mobileOpen)}
              aria-label="Toggle menu"
            >
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                {mobileOpen ? (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                ) : (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                )}
              </svg>
            </button>
          </div>
        </div>
      </div>

      {/* Mobile menu */}
      {mobileOpen && <MobileMenu onClose={() => setMobileOpen(false)} />}
    </header>
  );
}
```

**Step 2: Create LanguageSwitcher**

```tsx
// site/src/components/LanguageSwitcher.tsx
"use client";

import { useLocale } from "next-intl";
import { useRouter, usePathname } from "@/i18n/navigation";

const locales = [
  { code: "en", label: "EN" },
  { code: "pt", label: "PT" },
  { code: "es", label: "ES" },
] as const;

export default function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();

  return (
    <div className="flex items-center gap-0.5 bg-pb-bg-surface rounded-lg p-0.5">
      {locales.map(({ code, label }) => (
        <button
          key={code}
          onClick={() => router.replace(pathname, { locale: code })}
          className={`px-2 py-1 text-xs font-mono font-medium rounded transition-colors ${
            locale === code
              ? "bg-pb-accent-blue text-white"
              : "text-pb-text-muted hover:text-pb-text-primary"
          }`}
        >
          {label}
        </button>
      ))}
    </div>
  );
}
```

**Step 3: Create MobileMenu**

```tsx
// site/src/components/MobileMenu.tsx
"use client";

import { useTranslations } from "next-intl";
import { Link } from "@/i18n/navigation";

const menuItems = [
  { key: "trending", href: "/" },
  { key: "politics", href: "/category/politics" },
  { key: "crypto", href: "/category/crypto" },
  { key: "aiTech", href: "/category/ai-tech" },
  { key: "sports", href: "/category/sports" },
  { key: "markets", href: "/category/markets" },
  { key: "culture", href: "/category/culture" },
  { key: "community", href: "/community" },
  { key: "about", href: "/about" },
] as const;

export default function MobileMenu({ onClose }: { onClose: () => void }) {
  const t = useTranslations("nav");

  return (
    <div className="md:hidden border-t border-white/5 bg-pb-bg-secondary">
      <nav className="px-4 py-4 space-y-1">
        {menuItems.map(({ key, href }) => (
          <Link
            key={key}
            href={href}
            onClick={onClose}
            className="block px-3 py-2.5 text-sm font-medium text-pb-text-secondary hover:text-pb-text-primary hover:bg-pb-bg-surface rounded-lg transition-colors"
          >
            {t(key)}
          </Link>
        ))}
      </nav>
    </div>
  );
}
```

**Step 4: Create Footer**

```tsx
// site/src/components/Footer.tsx
"use client";

import { useTranslations } from "next-intl";
import { Link } from "@/i18n/navigation";

export default function Footer() {
  const t = useTranslations("footer");
  const nav = useTranslations("nav");

  return (
    <footer className="bg-pb-bg-secondary border-t border-white/5 mt-auto">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 py-12">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {/* Brand */}
          <div className="md:col-span-2">
            <span className="text-xl font-bold text-pb-text-primary tracking-tight">
              PREDICTION<span className="text-pb-accent-blue">BETS</span>
            </span>
            <p className="mt-3 text-sm text-pb-text-secondary max-w-md">
              {t("tagline")}
            </p>
          </div>

          {/* Navigation */}
          <div>
            <h3 className="text-sm font-semibold text-pb-text-primary uppercase tracking-wider mb-4">
              Signal
            </h3>
            <ul className="space-y-2">
              {["politics", "crypto", "aiTech", "markets"].map((key) => (
                <li key={key}>
                  <Link
                    href={`/category/${key === "aiTech" ? "ai-tech" : key}`}
                    className="text-sm text-pb-text-muted hover:text-pb-text-primary transition-colors"
                  >
                    {nav(key)}
                  </Link>
                </li>
              ))}
            </ul>
          </div>

          {/* Community */}
          <div>
            <h3 className="text-sm font-semibold text-pb-text-primary uppercase tracking-wider mb-4">
              Tribe
            </h3>
            <ul className="space-y-2">
              {[
                { label: nav("community"), href: "/community" },
                { label: nav("about"), href: "/about" },
                { label: nav("newsletter"), href: "/newsletter" },
              ].map(({ label, href }) => (
                <li key={href}>
                  <Link
                    href={href}
                    className="text-sm text-pb-text-muted hover:text-pb-text-primary transition-colors"
                  >
                    {label}
                  </Link>
                </li>
              ))}
            </ul>
          </div>
        </div>

        {/* Bottom */}
        <div className="mt-12 pt-8 border-t border-white/5 text-center">
          <p className="text-xs text-pb-text-muted">
            &copy; {new Date().getFullYear()} Prediction Bets. {t("rights")}
          </p>
        </div>
      </div>
    </footer>
  );
}
```

**Step 5: Wire Header and Footer into locale layout**

Update `site/src/app/[locale]/layout.tsx` to include Header and Footer components.

**Step 6: Verify navigation works**

- Desktop: category tabs clickable, language switcher works
- Mobile: hamburger menu opens/closes
- All three locales render correctly

**Step 7: Commit**

```bash
git add -A
git commit -m "feat: header, footer, navigation with i18n and mobile menu"
```

---

## Task 5: Content System (Markdown Articles Library)

**Files:**
- Create: `site/src/lib/articles.ts`
- Create: `site/src/content/articles/` (directory)
- Create: `site/src/content/articles/en/` (directory)
- Create: `site/src/content/articles/es/` (directory)
- Create: `site/src/types/article.ts`

**Step 1: Define Article types**

```typescript
// site/src/types/article.ts
export type ContentType = "signal" | "analysis" | "reality-check" | "culture" | "edge";

export type Category =
  | "politics"
  | "crypto"
  | "ai-tech"
  | "sports"
  | "markets"
  | "culture"
  | "geopolitics";

export interface ArticleFrontmatter {
  title: string;
  subtitle?: string;
  date: string;
  author: string;
  authorSlug: string;
  category: Category;
  tags: string[];
  image: string;
  imageCaption: string;
  excerpt: string;
  contentType: ContentType;
  featured: boolean;
  lang: string;
}

export interface Article extends ArticleFrontmatter {
  slug: string;
  content: string;
  readingTime: number;
}
```

**Step 2: Create articles library**

```typescript
// site/src/lib/articles.ts
import fs from "fs";
import path from "path";
import matter from "gray-matter";
import { remark } from "remark";
import html from "remark-html";
import type { Article, ArticleFrontmatter, Category } from "@/types/article";

const CONTENT_DIR = path.join(process.cwd(), "src/content/articles");

function getArticleDir(locale: string): string {
  if (locale === "en") return CONTENT_DIR;
  return path.join(CONTENT_DIR, locale);
}

function calculateReadingTime(content: string): number {
  const wordsPerMinute = 200;
  const words = content.trim().split(/\s+/).length;
  return Math.max(1, Math.ceil(words / wordsPerMinute));
}

export async function getArticleBySlug(
  slug: string,
  locale: string = "en"
): Promise<Article | null> {
  const dir = getArticleDir(locale);
  const filePath = path.join(dir, `${slug}.md`);

  if (!fs.existsSync(filePath)) return null;

  const raw = fs.readFileSync(filePath, "utf-8");
  const { data, content } = matter(raw);
  const frontmatter = data as ArticleFrontmatter;

  const processed = await remark().use(html).process(content);

  return {
    ...frontmatter,
    slug,
    content: processed.toString(),
    readingTime: calculateReadingTime(content),
  };
}

export async function getAllArticles(
  locale: string = "en"
): Promise<Article[]> {
  const dir = getArticleDir(locale);

  if (!fs.existsSync(dir)) return [];

  const files = fs
    .readdirSync(dir)
    .filter((f) => f.endsWith(".md") && !f.startsWith("."));

  const articles = await Promise.all(
    files.map(async (file) => {
      const slug = file.replace(/\.md$/, "");
      return getArticleBySlug(slug, locale);
    })
  );

  return articles
    .filter((a): a is Article => a !== null)
    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
}

export async function getArticlesByCategory(
  category: Category,
  locale: string = "en"
): Promise<Article[]> {
  const all = await getAllArticles(locale);
  return all.filter((a) => a.category === category);
}

export async function getFeaturedArticles(
  locale: string = "en"
): Promise<Article[]> {
  const all = await getAllArticles(locale);
  return all.filter((a) => a.featured);
}

export function getAllSlugs(locale: string = "en"): string[] {
  const dir = getArticleDir(locale);
  if (!fs.existsSync(dir)) return [];

  return fs
    .readdirSync(dir)
    .filter((f) => f.endsWith(".md"))
    .map((f) => f.replace(/\.md$/, ""));
}
```

**Step 3: Create a sample article for testing**

Create `site/src/content/articles/prediction-markets-are-eating-the-world-sample1.md` with proper frontmatter and a body written in the Prediction Bets voice.

**Step 4: Verify article loading works**

Create a quick test page or use the dev console to confirm `getAllArticles("en")` returns the sample article.

**Step 5: Commit**

```bash
git add -A
git commit -m "feat: content system with markdown articles and reading time"
```

---

## Task 6: Article Card Component

**Files:**
- Create: `site/src/components/ArticleCard.tsx`
- Create: `site/src/components/CategoryBadge.tsx`

**Step 1: Create CategoryBadge**

```tsx
// site/src/components/CategoryBadge.tsx
import type { Category } from "@/types/article";

const categoryColors: Record<Category, string> = {
  politics: "bg-purple-500/10 text-purple-400",
  crypto: "bg-orange-500/10 text-orange-400",
  "ai-tech": "bg-cyan-500/10 text-cyan-400",
  sports: "bg-green-500/10 text-green-400",
  markets: "bg-pb-accent-blue/10 text-pb-accent-blue",
  culture: "bg-pink-500/10 text-pink-400",
  geopolitics: "bg-red-500/10 text-red-400",
};

const categoryLabels: Record<Category, string> = {
  politics: "Politics",
  crypto: "Crypto",
  "ai-tech": "AI & Tech",
  sports: "Sports",
  markets: "Markets",
  culture: "Culture",
  geopolitics: "Geopolitics",
};

export default function CategoryBadge({ category }: { category: Category }) {
  return (
    <span
      className={`badge ${categoryColors[category] ?? "bg-pb-bg-surface text-pb-text-secondary"}`}
    >
      {categoryLabels[category] ?? category}
    </span>
  );
}
```

**Step 2: Create ArticleCard**

A Polymarket-style card adapted for editorial content: image, category badge, title, excerpt, author, date.

```tsx
// site/src/components/ArticleCard.tsx
import { Link } from "@/i18n/navigation";
import CategoryBadge from "./CategoryBadge";
import type { Article } from "@/types/article";

interface ArticleCardProps {
  article: Article;
  featured?: boolean;
}

export default function ArticleCard({ article, featured = false }: ArticleCardProps) {
  return (
    <Link href={`/article/${article.slug}`} className="group block">
      <article className={`card overflow-hidden ${featured ? "md:flex" : ""}`}>
        {/* Image */}
        <div
          className={`relative overflow-hidden ${
            featured ? "md:w-1/2 aspect-[16/9] md:aspect-auto" : "aspect-[16/9]"
          }`}
        >
          <img
            src={article.image}
            alt={article.title}
            className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
            loading="lazy"
          />
          <div className="absolute inset-0 bg-gradient-to-t from-pb-bg-primary/60 to-transparent" />
          <div className="absolute top-3 left-3">
            <CategoryBadge category={article.category} />
          </div>
        </div>

        {/* Content */}
        <div className={`p-5 ${featured ? "md:w-1/2 md:p-8 md:flex md:flex-col md:justify-center" : ""}`}>
          <h3
            className={`font-bold text-pb-text-primary group-hover:text-pb-accent-blue transition-colors line-clamp-2 ${
              featured ? "text-display-md" : "text-lg"
            }`}
          >
            {article.title}
          </h3>

          {article.subtitle && featured && (
            <p className="mt-2 text-pb-text-secondary text-sm line-clamp-2">
              {article.subtitle}
            </p>
          )}

          <p className={`mt-2 text-pb-text-muted text-sm line-clamp-2 ${featured ? "line-clamp-3" : ""}`}>
            {article.excerpt}
          </p>

          {/* Meta */}
          <div className="mt-4 flex items-center gap-3 text-xs text-pb-text-muted">
            <span className="font-medium text-pb-text-secondary">
              {article.author}
            </span>
            <span>&middot;</span>
            <span>{article.date}</span>
            <span>&middot;</span>
            <span className="font-mono text-pb-accent-blue">
              {article.readingTime}m
            </span>
          </div>
        </div>
      </article>
    </Link>
  );
}
```

**Step 3: Verify card renders with sample article**

**Step 4: Commit**

```bash
git add -A
git commit -m "feat: ArticleCard and CategoryBadge components"
```

---

## Task 7: Home Page

**Files:**
- Modify: `site/src/app/[locale]/page.tsx`

**Step 1: Build home page with editorial feed**

The home page has:
- Hero section with featured article
- Category filter tabs
- Article grid (3 columns on desktop)
- Newsletter CTA sidebar/section
- "Join the Tribe" CTA

```tsx
// site/src/app/[locale]/page.tsx
import { getTranslations } from "next-intl/server";
import { getAllArticles, getFeaturedArticles } from "@/lib/articles";
import ArticleCard from "@/components/ArticleCard";
import { Link } from "@/i18n/navigation";

type Props = {
  params: Promise<{ locale: string }>;
};

export default async function HomePage({ params }: Props) {
  const { locale } = await params;
  const t = await getTranslations("home");
  const nav = await getTranslations("nav");

  const articles = await getAllArticles(locale);
  const featured = articles.find((a) => a.featured) ?? articles[0];
  const rest = articles.filter((a) => a.slug !== featured?.slug);

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 py-8">
      {/* Hero */}
      {featured && (
        <section className="mb-12">
          <ArticleCard article={featured} featured />
        </section>
      )}

      {/* Category tabs */}
      <nav className="flex items-center gap-2 mb-8 overflow-x-auto pb-2 scrollbar-hide">
        {[
          { label: nav("trending"), href: "/" },
          { label: nav("politics"), href: "/category/politics" },
          { label: nav("crypto"), href: "/category/crypto" },
          { label: nav("aiTech"), href: "/category/ai-tech" },
          { label: nav("markets"), href: "/category/markets" },
          { label: nav("culture"), href: "/category/culture" },
        ].map(({ label, href }) => (
          <Link
            key={href}
            href={href}
            className="px-4 py-2 text-sm font-medium text-pb-text-secondary hover:text-pb-text-primary bg-pb-bg-surface hover:bg-pb-bg-surface-hover rounded-full transition-colors whitespace-nowrap"
          >
            {label}
          </Link>
        ))}
      </nav>

      {/* Article grid */}
      <section className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {rest.map((article) => (
          <ArticleCard key={article.slug} article={article} />
        ))}
      </section>

      {/* Empty state */}
      {articles.length === 0 && (
        <div className="text-center py-20">
          <p className="text-display-md text-pb-text-primary mb-4">
            Signal incoming.
          </p>
          <p className="text-pb-text-secondary">
            {t("newsletterCta")}
          </p>
        </div>
      )}

      {/* Newsletter CTA */}
      <section className="mt-16 card p-8 md:p-12 text-center">
        <h2 className="text-display-md text-pb-text-primary mb-3">
          {t("joinCta")}
        </h2>
        <p className="text-pb-text-secondary mb-6 max-w-md mx-auto">
          {t("newsletterCta")}
        </p>
        <div className="flex flex-col sm:flex-row items-center justify-center gap-3 max-w-md mx-auto">
          <input
            type="email"
            placeholder="your@email.com"
            className="w-full sm:flex-1 px-4 py-3 bg-pb-bg-primary border border-white/10 rounded-lg text-pb-text-primary placeholder:text-pb-text-muted focus:outline-none focus:border-pb-accent-blue"
          />
          <button className="btn-primary w-full sm:w-auto whitespace-nowrap">
            Get Signal
          </button>
        </div>
      </section>
    </div>
  );
}
```

**Step 2: Verify home page renders**

**Step 3: Commit**

```bash
git add -A
git commit -m "feat: home page with featured hero, article grid, and newsletter CTA"
```

---

## Task 8: Article Page

**Files:**
- Create: `site/src/app/[locale]/article/[slug]/page.tsx`

**Step 1: Build article detail page**

```tsx
// site/src/app/[locale]/article/[slug]/page.tsx
import { notFound } from "next/navigation";
import { getTranslations } from "next-intl/server";
import { getArticleBySlug, getAllArticles, getAllSlugs } from "@/lib/articles";
import CategoryBadge from "@/components/CategoryBadge";
import ArticleCard from "@/components/ArticleCard";
import type { Metadata } from "next";

type Props = {
  params: Promise<{ locale: string; slug: string }>;
};

export async function generateStaticParams() {
  const slugs = getAllSlugs("en");
  const locales = ["en", "pt", "es"];
  return locales.flatMap((locale) =>
    slugs.map((slug) => ({ locale, slug }))
  );
}

export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const { locale, slug } = await params;
  const article = await getArticleBySlug(slug, locale);
  if (!article) return { title: "Not Found" };

  return {
    title: `${article.title} | Prediction Bets`,
    description: article.excerpt,
    openGraph: {
      title: article.title,
      description: article.excerpt,
      images: [article.image],
      type: "article",
    },
    twitter: {
      card: "summary_large_image",
      title: article.title,
      description: article.excerpt,
      images: [article.image],
    },
  };
}

export default async function ArticlePage({ params }: Props) {
  const { locale, slug } = await params;
  const t = await getTranslations("article");

  const article = await getArticleBySlug(slug, locale);
  if (!article) notFound();

  // Get related articles (same category, exclude current)
  const all = await getAllArticles(locale);
  const related = all
    .filter((a) => a.category === article.category && a.slug !== slug)
    .slice(0, 3);

  return (
    <article className="max-w-4xl mx-auto px-4 sm:px-6 py-8">
      {/* Header */}
      <header className="mb-8">
        <CategoryBadge category={article.category} />
        <h1 className="mt-4 text-display-lg text-pb-text-primary">
          {article.title}
        </h1>
        {article.subtitle && (
          <p className="mt-3 text-xl text-pb-text-secondary">
            {article.subtitle}
          </p>
        )}
        <div className="mt-6 flex items-center gap-3 text-sm text-pb-text-muted">
          <span className="font-medium text-pb-text-secondary">
            {t("by")} {article.author}
          </span>
          <span>&middot;</span>
          <span>{article.date}</span>
          <span>&middot;</span>
          <span className="font-mono text-pb-accent-blue">
            {t("readTime", { minutes: article.readingTime })}
          </span>
        </div>
      </header>

      {/* Hero image */}
      <div className="relative aspect-[2/1] rounded-xl overflow-hidden mb-10">
        <img
          src={article.image}
          alt={article.title}
          className="w-full h-full object-cover"
        />
        {article.imageCaption && (
          <p className="absolute bottom-0 left-0 right-0 px-4 py-2 bg-black/60 text-xs text-pb-text-muted">
            {article.imageCaption}
          </p>
        )}
      </div>

      {/* Body */}
      <div
        className="prose prose-invert prose-lg max-w-none
          prose-headings:text-pb-text-primary prose-headings:font-bold
          prose-p:text-pb-text-secondary prose-p:leading-relaxed
          prose-a:text-pb-accent-blue prose-a:no-underline hover:prose-a:underline
          prose-strong:text-pb-text-primary
          prose-blockquote:border-pb-accent-blue prose-blockquote:text-pb-text-secondary
          prose-code:text-pb-accent-amber prose-code:bg-pb-bg-surface prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded
          prose-hr:border-white/10"
        dangerouslySetInnerHTML={{ __html: article.content }}
      />

      {/* Tags */}
      <div className="mt-10 pt-6 border-t border-white/10">
        <div className="flex flex-wrap gap-2">
          {article.tags.map((tag) => (
            <span
              key={tag}
              className="px-3 py-1 text-xs font-mono text-pb-text-muted bg-pb-bg-surface rounded-full"
            >
              #{tag}
            </span>
          ))}
        </div>
      </div>

      {/* Related */}
      {related.length > 0 && (
        <section className="mt-16">
          <h2 className="text-xl font-bold text-pb-text-primary mb-6">
            {t("related")}
          </h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            {related.map((a) => (
              <ArticleCard key={a.slug} article={a} />
            ))}
          </div>
        </section>
      )}
    </article>
  );
}
```

**Step 2: Install Tailwind typography plugin**

```bash
cd site && npm install @tailwindcss/typography
```

Add to `tailwind.config.ts` plugins array: `require("@tailwindcss/typography")`

**Step 3: Verify article page renders with sample article**

**Step 4: Commit**

```bash
git add -A
git commit -m "feat: article detail page with SEO metadata and related articles"
```

---

## Task 9: Category Page

**Files:**
- Create: `site/src/app/[locale]/category/[slug]/page.tsx`

**Step 1: Build category filtered page**

Same grid as home but filtered by category. Reuses ArticleCard. Include generateStaticParams for all categories.

**Step 2: Verify filtering works**

**Step 3: Commit**

```bash
git add -A
git commit -m "feat: category pages with filtered article grid"
```

---

## Task 10: About Page (Manifesto)

**Files:**
- Create: `site/src/app/[locale]/about/page.tsx`

**Step 1: Build the manifesto page**

This is the cultural heart of the site. Sections:
- Creation Story
- Creed (4 principles)
- Sacred Words (tribal glossary)
- Who we stand against (Pagans)

Dark, dramatic, typographically bold. Uses the content from the guidance document.

**Step 2: Verify it renders**

**Step 3: Commit**

```bash
git add -A
git commit -m "feat: about page with manifesto, creed, and sacred words"
```

---

## Task 11: Newsletter Page

**Files:**
- Create: `site/src/app/[locale]/newsletter/page.tsx`

**Step 1: Build newsletter capture page**

Simple, focused email capture page. Bold headline, email input, CTA button. Can integrate with Mailchimp/Resend/ConvertKit later — for now just the UI.

**Step 2: Commit**

```bash
git add -A
git commit -m "feat: newsletter capture page"
```

---

## Task 12: Database Setup (Prisma + PostgreSQL)

**Files:**
- Create: `site/prisma/schema.prisma`
- Create: `site/.env.local` (template)
- Modify: `site/package.json` (add prisma scripts)

**Step 1: Install Prisma**

```bash
cd site
npm install prisma @prisma/client
npx prisma init
```

**Step 2: Define schema**

```prisma
// site/prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  emailVerified DateTime?
  image         String?
  password      String?
  provider      String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  accounts Account[]
  sessions Session[]
  threads  Thread[]
  replies  Reply[]
  votes    Vote[]
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

// Forum models

model Thread {
  id        String   @id @default(cuid())
  title     String
  body      String
  section   String   // signalDrop, contrarianTakes, predictionBattles, etc.
  isPinned  Boolean  @default(false)
  upvotes   Int      @default(0)
  downvotes Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  authorId String
  author   User    @relation(fields: [authorId], references: [id], onDelete: Cascade)
  replies  Reply[]
  votes    Vote[]

  @@index([section, createdAt])
  @@index([authorId])
}

model Reply {
  id        String   @id @default(cuid())
  body      String
  upvotes   Int      @default(0)
  downvotes Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  authorId      String
  author        User    @relation(fields: [authorId], references: [id], onDelete: Cascade)
  threadId      String
  thread        Thread  @relation(fields: [threadId], references: [id], onDelete: Cascade)
  parentReplyId String?
  parentReply   Reply?  @relation("ReplyToReply", fields: [parentReplyId], references: [id])
  childReplies  Reply[] @relation("ReplyToReply")
  votes         Vote[]

  @@index([threadId, createdAt])
  @@index([authorId])
}

model Vote {
  id         String   @id @default(cuid())
  value      Int      // +1 or -1
  createdAt  DateTime @default(now())

  userId   String
  user     User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  threadId String?
  thread   Thread? @relation(fields: [threadId], references: [id], onDelete: Cascade)
  replyId  String?
  reply    Reply?  @relation(fields: [replyId], references: [id], onDelete: Cascade)

  @@unique([userId, threadId])
  @@unique([userId, replyId])
}
```

**Step 3: Create Prisma client singleton**

```typescript
// site/src/lib/prisma.ts
import { PrismaClient } from "@prisma/client";

const globalForPrisma = globalThis as unknown as { prisma: PrismaClient };

export const prisma = globalForPrisma.prisma ?? new PrismaClient();

if (process.env.NODE_ENV !== "production") globalForPrisma.prisma = prisma;
```

**Step 4: Set up .env.local template**

```
DATABASE_URL="postgresql://..."
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="generate-a-secret-here"
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
APPLE_ID=""
APPLE_SECRET=""
FACEBOOK_CLIENT_ID=""
FACEBOOK_CLIENT_SECRET=""
```

**Step 5: Generate Prisma client and push schema**

```bash
npx prisma generate
npx prisma db push
```

**Step 6: Commit**

```bash
git add -A
git commit -m "feat: Prisma schema with User, Thread, Reply, Vote models"
```

---

## Task 13: Authentication (NextAuth.js)

**Files:**
- Create: `site/src/app/api/auth/[...nextauth]/route.ts`
- Create: `site/src/lib/auth.ts`
- Create: `site/src/app/[locale]/auth/signin/page.tsx`

**Step 1: Install NextAuth**

```bash
cd site && npm install next-auth@^4 @next-auth/prisma-adapter
```

**Step 2: Configure NextAuth with Prisma adapter + social providers**

```typescript
// site/src/lib/auth.ts
import { PrismaAdapter } from "@next-auth/prisma-adapter";
import type { NextAuthOptions } from "next-auth";
import GoogleProvider from "next-auth/providers/google";
import FacebookProvider from "next-auth/providers/facebook";
import AppleProvider from "next-auth/providers/apple";
import EmailProvider from "next-auth/providers/email";
import { prisma } from "./prisma";

export const authOptions: NextAuthOptions = {
  adapter: PrismaAdapter(prisma),
  providers: [
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),
    FacebookProvider({
      clientId: process.env.FACEBOOK_CLIENT_ID!,
      clientSecret: process.env.FACEBOOK_CLIENT_SECRET!,
    }),
    AppleProvider({
      clientId: process.env.APPLE_ID!,
      clientSecret: process.env.APPLE_SECRET!,
    }),
    EmailProvider({
      server: process.env.EMAIL_SERVER,
      from: process.env.EMAIL_FROM ?? "noreply@predictionbets.com",
    }),
  ],
  pages: {
    signIn: "/auth/signin",
    verifyRequest: "/auth/verify",
  },
  callbacks: {
    session: async ({ session, user }) => {
      if (session.user) {
        session.user.id = user.id;
      }
      return session;
    },
  },
};
```

**Step 3: Create API route**

```typescript
// site/src/app/api/auth/[...nextauth]/route.ts
import NextAuth from "next-auth";
import { authOptions } from "@/lib/auth";

const handler = NextAuth(authOptions);
export { handler as GET, handler as POST };
```

**Step 4: Build sign-in page**

Dark themed login page with social buttons (Google, Apple, Facebook) + email input. Styled consistently with the rest of the site.

**Step 5: Verify auth flow works with at least one provider**

**Step 6: Commit**

```bash
git add -A
git commit -m "feat: NextAuth.js with social login and email verification"
```

---

## Task 14: Forum — API Routes

**Files:**
- Create: `site/src/app/api/forum/threads/route.ts` (GET list, POST create)
- Create: `site/src/app/api/forum/threads/[id]/route.ts` (GET single)
- Create: `site/src/app/api/forum/threads/[id]/replies/route.ts` (GET, POST)
- Create: `site/src/app/api/forum/vote/route.ts` (POST)

**Step 1: Create thread list/create endpoint**

GET: Returns threads for a section, sorted by hot/new/top.
POST: Creates a new thread (requires auth + verified email).

**Step 2: Create thread detail endpoint**

GET: Returns single thread with replies.

**Step 3: Create reply endpoint**

GET: Returns replies for a thread.
POST: Creates a reply (requires auth).

**Step 4: Create vote endpoint**

POST: Upvote/downvote a thread or reply. Toggles if already voted.

**Step 5: Test all endpoints with curl/Postman**

**Step 6: Commit**

```bash
git add -A
git commit -m "feat: forum API routes for threads, replies, and votes"
```

---

## Task 15: Forum — UI Pages

**Files:**
- Create: `site/src/app/[locale]/community/page.tsx` (section list)
- Create: `site/src/app/[locale]/community/[section]/page.tsx` (thread list)
- Create: `site/src/app/[locale]/community/[section]/[threadId]/page.tsx` (thread detail)
- Create: `site/src/app/[locale]/community/new/page.tsx` (create thread)
- Create: `site/src/components/forum/ThreadCard.tsx`
- Create: `site/src/components/forum/ReplyCard.tsx`
- Create: `site/src/components/forum/VoteButton.tsx`
- Create: `site/src/components/forum/NewThreadForm.tsx`
- Create: `site/src/components/forum/ReplyForm.tsx`

**Step 1: Build community hub page**

Shows the 6 forum sections as cards:
- Signal Drop
- Contrarian Takes
- Prediction Battles
- Reality Check
- Edge Lab
- Off-Market

Each card shows: section name, description, thread count, latest activity.

**Step 2: Build thread list page**

For a given section: list of threads sorted by New/Hot/Top. Each thread shows title, author, upvotes, reply count, time.

**Step 3: Build thread detail page**

Shows thread body + nested replies. VoteButton on thread and each reply. ReplyForm at the bottom (requires auth).

**Step 4: Build new thread page**

Form: title, body (textarea with markdown support), section selector. Requires auth.

**Step 5: Build forum components (ThreadCard, ReplyCard, VoteButton, forms)**

**Step 6: Wire auth checks — show login CTA for unauthenticated users**

**Step 7: Verify full forum flow: login → create thread → reply → vote**

**Step 8: Commit**

```bash
git add -A
git commit -m "feat: community forum UI with threads, replies, and voting"
```

---

## Task 16: Python Agent Pipeline

**Files:**
- Create: `agent/` directory (entire pipeline)
- Create: `agent/config.py`
- Create: `agent/fetcher.py`
- Create: `agent/rewriter.py`
- Create: `agent/translator.py`
- Create: `agent/image_sourcer.py`
- Create: `agent/publisher.py`
- Create: `agent/main.py`
- Create: `agent/requirements.txt`
- Create: `agent/.env.example`

**Step 1: Copy Dinheirologia pipeline structure**

Replicate the exact same architecture from `/Users/macbookjoaohomem/Documents/VSCode_Projects/Dinheirologia/agent/`, adapting:

1. **config.py**: New RSS sources (prediction markets focused), new categories, new fictional authors, content output pointing to `site/src/content/articles/`

2. **fetcher.py**: Same RSS fetcher logic, different feeds

3. **rewriter.py**: NEW voice prompt (see below), adapted for prediction markets

4. **translator.py**: Same logic, adapted system prompt for prediction market terminology

5. **image_sourcer.py**: Same Unsplash logic, different search terms per category

6. **publisher.py**: Same logic, output to `site/src/content/articles/` (EN root, PT/ES in subdirs)

7. **main.py**: Same orchestration pipeline

**Step 2: Write the Prediction Bets voice prompt**

The core differentiator — the system prompt for Claude rewriter:

```python
_VOICE_SYSTEM_PROMPT = """\
You are a sharp, witty writer covering prediction markets for Prediction Bets —
the cultural center of prediction markets. Your style:

PERSONALITY:
- Sharp, direct, no corporate fluff. You cut through noise to find the signal.
- Acid humor and biting irony against "experts" who opine without skin in the game.
- Anti-establishment: skeptical of talking heads, clickbait forecasters, authority without accountability.
- Inspired by Nassim Taleb: if you don't have skin in the game, your opinion is noise.
- Pro-markets, pro-accountability, pro-reality. Markets don't lie, people do.
- Internet-native voice: memes, cultural references, Gen Z energy meets Wall Street edge.

WRITING STYLE:
- Pop culture and movie references (Matrix, Breaking Bad, Succession, The Big Short, etc.)
- Explain prediction market jargon in plain language with humor
- Occasional mild profanity when it lands (damn, hell, BS — never gratuitous)
- Deep analysis, never surface-level. Go beyond the headline.
- Use real examples: Polymarket, Kalshi, Metaculus data when relevant
- Provocative questions to the reader at the end
- Tone of insider letter, not corporate article
- Short paragraphs. Fast rhythm. Punchy.
- NEVER sound like AI or a press release
- Use tribal language naturally: signal, edge, consensus, reality check, market truth

ARTICLE STRUCTURE:
1. Opening punch (quote, anecdote, paradox, cultural reference, or slap in the face)
2. Cultural/historical analogy connecting to the prediction market event
3. Real analysis of what the market data actually says — no sugar coating
4. Education disguised as entertainment — teach a prediction concept naturally
5. Provocative close that challenges the reader. No summaries. End with a punch.

LANGUAGE: Write in {language}.
OUTPUT: Only the article body in Markdown. No frontmatter. No H1 title at the start.
"""
```

**Step 3: Configure RSS feeds for prediction markets**

```python
RSS_FEEDS = [
    {"name": "Google News Prediction Markets", "url": "https://news.google.com/rss/search?q=prediction+markets&hl=en-US", "language": "en", "category": "markets", "content_type": "signal"},
    {"name": "Google News Polymarket", "url": "https://news.google.com/rss/search?q=Polymarket&hl=en-US", "language": "en", "category": "markets", "content_type": "signal"},
    {"name": "Google News Kalshi", "url": "https://news.google.com/rss/search?q=Kalshi&hl=en-US", "language": "en", "category": "markets", "content_type": "signal"},
    {"name": "CoinDesk", "url": "https://www.coindesk.com/arc/outboundfeeds/rss/", "language": "en", "category": "crypto", "content_type": "signal"},
    {"name": "CNBC Finance", "url": "https://www.cnbc.com/id/10000664/device/rss/rss.html", "language": "en", "category": "markets", "content_type": "signal"},
    {"name": "Yahoo Finance", "url": "https://finance.yahoo.com/rss/", "language": "en", "category": "markets", "content_type": "signal"},
    {"name": "Seeking Alpha", "url": "https://seekingalpha.com/feed.xml", "language": "en", "category": "markets", "content_type": "analysis"},
    {"name": "Google News Elections", "url": "https://news.google.com/rss/search?q=election+odds+betting&hl=en-US", "language": "en", "category": "politics", "content_type": "signal"},
    {"name": "Google News AI Predictions", "url": "https://news.google.com/rss/search?q=AI+predictions+forecast&hl=en-US", "language": "en", "category": "ai-tech", "content_type": "signal"},
]
```

**Step 4: Configure fictional authors**

```python
FICTIONAL_AUTHORS = [
    "The Oracle of Odds",
    "Consensus Crusher",
    "Base Rate Betty",
    "Signal Samurai",
    "Edge Lord Eddie",
    "The Contrarian",
    "Probability Pete",
    "Market Truth Marta",
    "Skin-in-the-Game Steve",
    "Black Swan Brenda",
]
```

**Step 5: Set up Python virtual environment and install dependencies**

```bash
cd agent
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

**Step 6: Run a dry-run test**

```bash
python main.py --dry-run
```

Expected: Fetches articles, rewrites them, prints output without writing files.

**Step 7: Run full pipeline and verify articles appear in site/src/content/articles/**

```bash
python main.py
```

**Step 8: Verify articles render on the Next.js site**

```bash
cd ../site && npm run dev
```

**Step 9: Commit**

```bash
git add -A
git commit -m "feat: Python agent pipeline for prediction market content"
```

---

## Task 17: SEO Essentials

**Files:**
- Create: `site/src/app/robots.ts`
- Create: `site/src/app/sitemap.ts`
- Modify article pages for structured data

**Step 1: Create robots.ts**

```typescript
// site/src/app/robots.ts
import type { MetadataRoute } from "next";

export default function robots(): MetadataRoute.Robots {
  return {
    rules: { userAgent: "*", allow: "/" },
    sitemap: "https://predictionbets.com/sitemap.xml",
  };
}
```

**Step 2: Create sitemap.ts**

Dynamic sitemap that includes all articles across all locales.

**Step 3: Add JSON-LD structured data to article pages**

Article schema markup for Google.

**Step 4: Commit**

```bash
git add -A
git commit -m "feat: SEO with robots.txt, dynamic sitemap, and structured data"
```

---

## Task 18: Sample Content & Final Polish

**Files:**
- Create: 5-10 sample articles in `site/src/content/articles/`
- Or: Run the agent pipeline to generate initial content

**Step 1: Generate initial content batch**

Run the agent pipeline to produce 10-15 articles across categories.

```bash
cd agent && python main.py
```

**Step 2: Mark 1-2 articles as featured**

Edit frontmatter: `featured: true`

**Step 3: Verify full site experience**

- Home page loads with articles
- Category filtering works
- Article pages render correctly
- Forum sections visible
- Auth flow works
- All three locales render
- Mobile responsive
- Dark mode looks correct

**Step 4: Final commit**

```bash
git add -A
git commit -m "feat: initial content batch and final polish"
```

---

## Execution Order Summary

| # | Task | Dependencies | Estimated Effort |
|---|------|-------------|-----------------|
| 1 | Project Scaffold | None | Small |
| 2 | Design System | Task 1 | Small |
| 3 | i18n Setup | Task 1 | Medium |
| 4 | Header & Navigation | Tasks 2, 3 | Medium |
| 5 | Content System | Task 1 | Medium |
| 6 | Article Card Component | Tasks 2, 5 | Small |
| 7 | Home Page | Tasks 4, 5, 6 | Medium |
| 8 | Article Page | Tasks 5, 6 | Medium |
| 9 | Category Page | Tasks 5, 6 | Small |
| 10 | About Page | Tasks 2, 4 | Small |
| 11 | Newsletter Page | Tasks 2, 4 | Small |
| 12 | Database Setup | Task 1 | Medium |
| 13 | Authentication | Task 12 | Medium |
| 14 | Forum API Routes | Tasks 12, 13 | Large |
| 15 | Forum UI Pages | Tasks 13, 14 | Large |
| 16 | Python Agent Pipeline | Task 5 (output format) | Large |
| 17 | SEO | Tasks 5, 8 | Small |
| 18 | Sample Content & Polish | All above | Small |

### Parallelization Opportunities

- Tasks 5-6 (content) can run in parallel with Task 12 (database)
- Task 16 (Python agent) can run in parallel with Tasks 10-11 (static pages)
- Tasks 10, 11 are independent of each other
